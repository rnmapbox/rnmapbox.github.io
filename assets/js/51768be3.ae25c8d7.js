"use strict";(self.webpackChunkmap_docs=self.webpackChunkmap_docs||[]).push([[2520],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>y});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=r.createContext({}),u=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=u(e.components);return r.createElement(s.Provider,{value:n},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(t),d=a,y=c["".concat(s,".").concat(d)]||c[d]||m[d]||o;return t?r.createElement(y,i(i({ref:n},p),{},{components:t})):r.createElement(y,i({ref:n},p))}));function y(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=d;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[c]="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=t[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},6171:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var r=t(7462),a=(t(7294),t(3905));const o={title:"Query Terrain Elevation",tags:["MapView#queryTerrainElevation"],custom_props:{example_rel_path:"V10/QueryTerrainElevation.js"},custom_edit_url:"https://github.com/rnmapbox/maps/tree/master/example/src/examples/V10/QueryTerrainElevation.js"},i=void 0,l={unversionedId:"examples/V10/QueryTerrainElevation",id:"examples/V10/QueryTerrainElevation",title:"Query Terrain Elevation",description:"Query Terrain Elevation",source:"@site/docs/examples/V10/QueryTerrainElevation.md",sourceDirName:"examples/V10",slug:"/examples/V10/QueryTerrainElevation",permalink:"/docs/examples/V10/QueryTerrainElevation",draft:!1,editUrl:"https://github.com/rnmapbox/maps/tree/master/example/src/examples/V10/QueryTerrainElevation.js",tags:[{label:"MapView#queryTerrainElevation",permalink:"/docs/tags/map-view-query-terrain-elevation"}],version:"current",frontMatter:{title:"Query Terrain Elevation",tags:["MapView#queryTerrainElevation"],custom_props:{example_rel_path:"V10/QueryTerrainElevation.js"},custom_edit_url:"https://github.com/rnmapbox/maps/tree/master/example/src/examples/V10/QueryTerrainElevation.js"},sidebar:"examplesSidebar",previous:{title:"Markers",permalink:"/docs/examples/V10/Markers"},next:{title:"Terrain, Sky, & Atmosphere",permalink:"/docs/examples/V10/TerrainSkyAtmosphere"}},s={},u=[],p={toc:u},c="wrapper";function m(e){let{components:n,...o}=e;return(0,a.kt)(c,(0,r.Z)({},p,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Query Terrain Elevation"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useState, useEffect, useRef } from 'react';\nimport { Easing, Button, View, Text } from 'react-native';\nimport length from '@turf/length';\nimport { lineString } from '@turf/helpers';\nimport { Animated as RNAnimated } from 'react-native';\nimport {\n  MapView,\n  ShapeSource,\n  LineLayer,\n  SkyLayer,\n  Camera,\n  Logger,\n  Terrain,\n  RasterDemSource,\n  Animated,\n  MarkerView,\n  Atmosphere,\n} from '@rnmapbox/maps';\n\nimport Page from '../common/Page';\n\nLogger.setLogLevel('verbose');\n\nconst AnimatedMarkerView = RNAnimated.createAnimatedComponent(MarkerView);\n\nconst styles = {\n  mapView: { flex: 1 },\n  triangleStyle: (size, color) => ({\n    width: 0,\n    height: 0,\n    backgroundColor: 'transparent',\n    borderStyle: 'solid',\n    borderLeftWidth: size,\n    borderRightWidth: size,\n    borderTopWidth: size * 1.3,\n    borderLeftColor: 'transparent',\n    borderRightColor: 'transparent',\n    borderTopColor: color,\n  }),\n};\n\nconst QueryTerrainElevation = ({ ...props }) => {\n  let [routeGeojson, setRouteGeojson] = useState(null);\n  let [animatedRoute, setAnimatedRoute] = useState(null);\n  let [actPoint, setActPoint] = useState(null);\n  // let [pinRoute, setPinRoute] = useState(null);\n  let camera = useRef();\n  let [altitude, setAltitude] = useState(null);\n  let updateAltitudeInterval = useRef();\n  let map = useRef();\n  useEffect(() => {\n    return () => {\n      clearInterval(updateAltitudeInterval.current);\n      updateAltitudeInterval.current = null;\n    };\n  }, []);\n\n  function startAnimation(animatedRoute) {\n    const ts = lineString(animatedRoute.__getValue());\n    const total = length(ts, { units: 'meters' });\n    const points = animatedRoute.__getValue();\n    const endPoint = points[points.length - 1];\n\n    animatedRoute\n      .timing({\n        toValue: { end: { point: endPoint, from: total } },\n        duration: 20000,\n        easing: Easing.linear,\n      })\n      .start(() => {\n        clearInterval(updateAltitudeInterval.current);\n        updateAltitudeInterval.current = null;\n      });\n\n    camera.current.setCamera({\n      heading: 60,\n      zoomLevel: 13.5,\n      animationDuration: 20000,\n    });\n\n    updateAltitudeInterval.current = setInterval(async () => {\n      setAltitude(\n        Math.floor(\n          await map.current.queryTerrainElevation(actPoint.__getValue()),\n        ),\n      );\n    }, 2000);\n  }\n\n  useEffect(() => {\n    (async () => {\n      let response = await fetch(\n        'https://docs.mapbox.com/mapbox-gl-js/assets/route-pin.geojson',\n      );\n      let featureCollection = await response.json();\n      setRouteGeojson(featureCollection);\n      let pinRoute = featureCollection.features[0].geometry.coordinates;\n\n      let animatedRoute = new Animated.RouteCoordinatesArray(pinRoute, {\n        end: {\n          from: length(lineString(pinRoute)),\n        },\n      });\n      setAnimatedRoute(animatedRoute);\n      setActPoint(new Animated.ExtractCoordinateFromArray(animatedRoute, -1));\n      //setPinRoute(pinRoute);\n    })();\n  }, []);\n  return (\n    <Page {...props}>\n      <Button title=\"Start\" onPress={() => startAnimation(animatedRoute)} />\n      <MapView\n        style={styles.mapView}\n        styleURL={'mapbox://styles/mapbox/satellite-streets-v11'}\n        ref={map}\n      >\n        <Camera\n          centerCoordinate={[6.58968, 45.39701]}\n          zoomLevel={12.3}\n          heading={162}\n          pitch={76}\n          ref={camera}\n        />\n\n        <RasterDemSource\n          id=\"mapbox-dem\"\n          url=\"mapbox://mapbox.terrain-rgb\"\n          tileSize={512}\n          maxZoomLevel={14}\n        >\n          <SkyLayer\n            id=\"sky-layer\"\n            style={{\n              skyType: 'atmosphere',\n              skyAtmosphereColor: 'rgba(85, 151, 210, 0.5)',\n            }}\n          />\n\n          <Terrain style={{ exaggeration: 1.5 }} />\n          <Atmosphere\n            style={{\n              starIntensity: 1.0,\n              range: [-3.5, 10.0],\n              spaceColor: '#00ffff',\n              color: '#00ff00',\n              highColor: '#ff00ff',\n            }}\n          />\n        </RasterDemSource>\n\n        {routeGeojson && false && (\n          <ShapeSource id=\"route\" shape={routeGeojson}>\n            <LineLayer\n              id=\"root\"\n              style={{\n                lineColor: 'rgba(0,0,255,0)',\n                lineWidth: 5,\n                lineCap: 'round',\n                lineJoin: 'round',\n              }}\n            />\n          </ShapeSource>\n        )}\n        {animatedRoute && (\n          <Animated.ShapeSource\n            id=\"animated-route\"\n            shape={\n              new Animated.Shape({\n                type: 'LineString',\n                coordinates: animatedRoute,\n              })\n            }\n          >\n            <Animated.LineLayer\n              id={'animated-route'}\n              style={{\n                lineColor: 'rgba(255,0,0,0)',\n                lineWidth: 3,\n                lineCap: 'round',\n                lineJoin: 'round',\n              }}\n            />\n          </Animated.ShapeSource>\n        )}\n\n        {actPoint && (\n          <Animated.ShapeSource\n            id=\"currentLocationSource\"\n            shape={\n              new Animated.Shape({\n                type: 'Point',\n                coordinates: actPoint,\n              })\n            }\n          >\n            <Animated.CircleLayer\n              id=\"currentLocationCircle\"\n              style={{\n                circleOpacity: 1.0,\n                circleColor: '#c62221',\n                circleRadius: 6,\n              }}\n            />\n          </Animated.ShapeSource>\n        )}\n        {actPoint && altitude && (\n          <AnimatedMarkerView coordinate={actPoint} anchor={{ x: 0.5, y: 1 }}>\n            <View style={{ alignItems: 'center' }}>\n              <View\n                style={{\n                  backgroundColor: 'white',\n                  padding: 10,\n                  width: 140,\n                  height: 50,\n                  borderRadius: 10,\n                }}\n              >\n                <Text>Altitude: {altitude} m</Text>\n              </View>\n              <View\n                style={[styles.triangleStyle(12, 'white'), { marginTop: -1 }]}\n              />\n            </View>\n          </AnimatedMarkerView>\n        )}\n      </MapView>\n    </Page>\n  );\n};\n\nexport default QueryTerrainElevation;\n\n\n")),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"QueryTerrainElevation.png",src:t(3588).Z,width:"295",height:"640"}),"}"))}m.isMDXComponent=!0},3588:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/QueryTerrainElevation-7c12e18afdec7b1265484f781cd4e2ed.png"}}]);